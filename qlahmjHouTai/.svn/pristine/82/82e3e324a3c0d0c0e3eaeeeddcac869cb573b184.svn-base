(function(){var a,b,c,d,e,f,g,h,i=[].slice;window.readCookieName=function(a){var b,c;return c=new RegExp("s*"+a+"=([^;]*)"),b=document.cookie.match(c),b?b[1]:""},c=function(){var a,b,c;b=window.location.pathname,b=b.substring(1);try{c=readCookieName("currentUser"),c&&(c=JSON.parse(decodeURIComponent(c)))}catch(d){a=d}return _hmt.push(["_setCustomVar",1,"short",b]),window.short=b},d=function(a,b,c){var d;return d=a[b],a[b]=a[c],a[c]=d,a},c(),window.sanitize=function(a){var b;return b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},String(a).replace(/[&<>"'`=\/]/g,function(a){return b[a]})},g=function(a){return"string"==typeof a},h=function(a){var b,c,d;if(a){c={};for(b in a)d=a[b],g(d)?c[b]=sanitize(d):c[b]=d;return c}},a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAADLklEQVQ4T62Ua0hTYRjH/2dnO9uO23SnLbNyU8uk0oxISroQRiFdIelCEX2xMgKLEqIrFlJfWtCHykzo6ofKCm3dZFRmZSXdt5bWbJY6y3mbO2db286JQUEXO5PofXk/Pf//j//zwvMQiHL23+6b0mK3Jh7fOK0ymjZSJ34XvRMEzYXHULKu3gRSLpvg6BEKHlpuGFLigqXpSZp6ijY0G0bQXd1PKrzFxcX87/5fgNuqOk0N7apCmoLUF5IgQFAI+Hk0XDkBuFsBnQ7K2DgIhCw0erjaZj2yaKIoMO/w2wqbkLYSX/0gCYBRSRGvCuPp3Wp8cHYDwRggRAK8HAljFb2uk/O1osCcPXVHs2Zkb5g+QoBBS2AIDehoAZH7pY9AWw+H9+0e1Dz/gqdvHE572bJkUeCcffXHUjMnFcxKDGJqkhSJWhKA5PsDOJaF5UU7rj7+iDq7+1Nj+QqDKHCR6VWZU5ax1tnmhooikczwqMzXYpgqiIyN1bA+cwEsB8hjYZxoaGspXzBSFJh/qvNYU5gp4L0s/EEer1xhPChikKp0I272OUBPg1ZKwREMjDrl+5ay3FRR4D5LeMuNtyGTShpCjzcAZw9wcZ0WjN+JzDXVkOsVkCjU8PloZI7RPHp5KCdbFHjQ0jWuuinGplZI0Of1we4KoXQ1A7LTiiWbbkKZxICM0cPbFkD+kpGm8sLsIlFgpLiqwudwdJMpsfIwrK0ctuYyYJvrsdtUBzrViAChQbifg3lv1qgFWcbmqMCz1kDeAXOo0qin8KnLh9lpNDpsFpw3N4IeNRpccz/m5g431+yeuXCgUfxj9CKi7WZfaZVdsp5RkdBRHJqeXMWbVgAeCgnJso7204sTCYIIDRoYEe64zpbUOqmdHo8fr29dBrxBTJ6WXHuyMH15Rkr8578tigET/hCfsQlTahqFImfDvfh5k/QVO5aOPx5t44gCo5kH1bJwv0r97vydPKlWI6NZj8DKFXzV5DVhL6UhNTxHdLASYVh6/LXNGaoB2/4joaOkZLpv1666SEENoBdAzsr7cA9NA9gugJcgL6V79aWdU88NKuG/tPmz57//4TfNDDgk+K71PQAAAABJRU5ErkJggg==",b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAEcElEQVQ4T4WUW6gVVRjHf9+a294ze/beZ2+Pl2Nq5vGYJlYKpWAqRdRLD0Y9dAGfEnoIkooKCxG1HiqiLOghRCESEioxwUCQvJUgRBqdjLzk9Zx9Lp4zs28ze+9ZMfsIvSgthnlYrO+3/jPf9//L4OBgedPh8skLN42BgpOE3GZpBJh6325VY/FL2WRs+7raannmixtHj1+2H7m7J6GTgNaQVqbFSglRG4YmOiiB3rxBxoIkSQ/9twyBK5MGS6fHv0n/1rGgnE38JIH0XEdD3IFqUzNW7ZC1EjY95lJyFTuPNLg+CXlXyGUUjiEo0YiAoWCiKaEsf28kMAS/nWiGJjvYpqY3ZzAjLyyaYfDsCo+V8wyO/NngwjicG27xz7hmOEgYrWkmGlD2hIwpqZhQlm+vBFEb3zRg4+oMi2cqco5BX9Ggr8dEECpBzAeHAgpelgfnKrROCKOEZpxQjWDv6RY36xrX6gJHgjDSvmsl7NtYpK9gcyPQRO2k+x8LroFBi13HqlTqFp6tu2rynkEhq1nWJ2z+vs7vQx2m54xQHtg2ElRj/JzZ5vPne7AsgyjW2JbGMRWFrMKUiF1H64w2bMo5jW0IpqHoAAO9is9+DDg3oZmZN1NgZUqhJOx8oYhlGzSitIiukoJnYEmT3cfqjDQcyl56EYikDREWTIOPD4ZcaUg6BaHct3U4iNvit+pRF1gqZhivdsiYU8Cia5IxI/Ycr1KpOZRSoCXdkXIsxSw34aMDk0yITT5HKEu2VAIN/tXhiB3r86xclOXSaJuMLWQtRTFj4Nkxe46FVOqpQukqVApKviJLwvvfBZgFm4xDKPe+OxyIEv+vKxGvrM3w3Jo8g9fbeI6QsRUl18CzIr46WesqLHtgGdKd2YHZFhcvhXxyqMac+TlEdCgD70wBrw7HPLFQ8epTJc5e61DICo4NJc/Es2L2nqjdagrYpqIaJTzU73Dwp5vsPxPT3++m5gxlUQoU/GYzoR1GfLihRGJZBGEbL6Mo5UxyVot9P4eMNhxKOcE2BdNWzC/Cp/vGmFAmPdOsW8C3bwQIfurVwQtNNjzs8PL6Mkf+iCm7Qq9vkrXafHsqZDKyKXqKWpzw6P0uJ3+Z4MvDVRYuyaFSQ+v0k98aCgA/neIoTrh2ocaOFwusW9XDqXMt8hb0eB32n65RCRS+Z7J2WZbJoRrbdo/iznAplk1EUgcRysI3p4CpwZXSjIy0iMYiXnrS5fFVBUo9Ga6PxnxzImRG2WHhdOHSxTq7DkzSdBzumufQjSJkCtj32khQsNt+OwFRgiJhbLTNyPk6SxeYPL0mx4ol2W7nz19ucWawxqmzTfxZWWbOmYKlQ26IptayQln8xsVKJS729mYadPRUkKZPp625drnZVTtwj0XOUfz6d4zYBrPnZrCzBmKm0ZE6JmGi5eIS3JSvfzi+4fWDvbuVXWw6ZquV3pYSu/msIWkljI+30Qn0FBSGYyBpA26FsNaaljaNWrXubll7ffOdUv0OYf//2/8CnLPg53p/3ssAAAAASUVORK5CYII=",e=function(a){return null==a&&(a=""),a.substr(a.lastIndexOf("/")+1,a.length)},f=function(){var a,b,c,d;for(d=[/oppo|JLS36C|KTU84P/gi,/vivo/gi],b=0,c=d.length;b<c;b++)if(a=d[b],a.test(navigator.userAgent))return!0;return!1},$(function(){var c,g,j,k,l,m,n;c=$("body"),g=$(".main"),k="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAABNVBMVEXzpkDzpkHzp0Lzp0PzqETzqUjzqkjzqknzrE7zrU/0rVD0r1P0r1T0sFX0sFb0sFf0sVf0sVj0sVn0slr1tWD1tWH1tmL1tmP1t2T1umz1u231u2/2vG/2vHD2vXH2wHj2wXr2wXv2wnz2wn32wn72w373xYL3xYT3xoT3xoX3x4f3x4j3yIn3yIr3yYv3yYz3yo34zJL4zJP4zZT4zpb4z5n50p/506H506L51KL51KP516v52Kz52a762q/62rD62rH63rn63rr637v637z64L375Mb75cj75cn75sn75sr86tP869T869X87Nb87Nf879798N/98OD98eH98eL98uP98uT98+X98+b99On99er99ev99uz++PH++fL++fP++/f++/j+/Pn+/fz+/v3+/v7///+pZW9PAAAC/0lEQVR4AezBgQAAAACAoP2pF6kCAAAAAAAAAAAAAABm376aWjmiIAD3XnEvWQQTMGACyIGAAzkHkMDkIDAGJCGxov//T3ChObWlAVRlrVQ1e8r+3qb0dB521bPT85/R/tPcd4B+S0WyuAT1fmPJr1DOu2PJnQfdEhQJ6HZJcQnVRhgYgWYnDJxAsQGWGYBeKZZJQa1un2X8bmi1S8sulGp5oeWlBTqt8511qNT4TOPqisZzIzRapJiaoliEQg1PNB5isQcaTw3QZ45iHpinmIM6XppG9ivwNUsj7UGbSYrlt9UyxSS0uaCRb3pbNeVpXECZYYpNs96kGIYuxzT8DrPu8GkcQ5V+in2IfYp+aJKk6IXopUhCkS6fxiEChzT8LuixTTGIwCDFtqL8XqBxhjJnNAp60vwaxRjKjFGsQYlvORo3sNzQyH3Tlt+nYZlWluYbHmk8xmCJBT/oSPMzFAt4Z4FiBhqkKz4KwcOThgLjFCv4YIViHNF3TqPQjA+aCzTOEXlDFFv4xBbFEKLuiIbfiU90+jSOEHF9FAf41AFFH6KjLZlhHWVS7Y7myLLOcm4mSbLuUnAhw7rL/D9ILVKsuyRcaM+xzrJtcDNJqr6v36TM4dxsxfxeIc3PIpqsrWyIrbCG/F45zSvL75XTvLb8rijNH1XxSbQrSPPq8ruCNC8Oqjo26LfHdi/01u9PeyMZHfbjG/7V4FpTvtoX6rl1WBoZKxQT+Jcm7L/PiAhRCLAKBZFhx8DwEdO1EKUZq3QD98IffFjHKFFxHRTLQhXTrhERYyGrfuv2UaN7p0H5MmR58xSRMEixgyrtUHyPKDgMXVDutgoSrvW80kiF/zT22gP39moo8Q9Q7MG5uE/jpJZrGX4crm1Q/FDTRZkNuHZP47K2q0t/w7EvRRqJ2i6TFb/Asb9YcushFO+WJfdRuTA5ipBGWfI7XPNWi2RhHqH9kSeLqx7ci//yYytq0Jr4OY5/2oMDGQAAAIBB/tb3+KoLAAAAAAAAAAAAAAAg6P6/9f2bMMkAAAAASUVORK5CYII=",j=window.innerHeight,n={zh:{AUTO_RETURN_HOME:"<label id='countdown'>{{countdown}}</label> 秒后返回首页",LOADING:"加载中...",DOWNLOAD_INSTALL:"下载安装",DOWNLOAD_LOADING:"下载中",DATA_ERROR:"数据错误",DATA_INCOMPLETE:"请联系应用开发者, <a href='/apps/new'>去新版重新上传</p>",DATA_INCOMPLETE_IN_MOBILE:"请联系应用开发者重新上传",DOWNLOAD_FAILED:"刷新并重试",VIEW_IN_DESKTOP:"正在安装，请按 Home 键在桌面查看",PLATFORM_NOT_MATCHING:"只支持 {{app|app_type}} 设备",CHANGELOG_PLACEHOLDER:"没有更新日志",FAILED_LOAD_APP:"加载失败",NOT_FOUND_TITLE:"404 - Not Found",NOT_FOUND_LOG:"您访问的 应用/页面 不存在",FORBIDDEN_TITLE:"403 - Forbidden",FORBIDDEN_TITLE_LOG:"您没有权限访问这个应用",REQUIRE_PWD:"请输入密码",PASSWORD_WRONG:"密码错误",SCAN_TIPS:"扫描二维码下载<br/>或用手机浏览器输入这个网址:&nbsp;&nbsp;<span class='text-black'>{{full_short}}</span>",DESC:"应用描述",CURRENT_VERSION:"当前版本",FILE_SIZE:"文件大小",UPDATED_AT:"更新于",RELEASES:"历史版本",CHANGELOG:"更新日志",VIEW_ALL_APP_RELEASES:"查看全部 {{app.histories|length}} 个历史版本",VIEW_ALL_APP_RELEASES_IOS:"查看全部 {{ios.histories|length}} 个历史版本",VIEW_ALL_APP_RELEASES_ANDROID:"查看全部 {{android.histories|length}} 个历史版本",FOLDING:"隐藏",VIEW_ALL_COMBOAPP_RELEASES:"查看全部 {{combo_app.releases|length}} 个历史版本",SCREENSHOTS:"应用截图",INHOUSE:"123",ADHOC:"内测版",CONFIRM:"确认",GO_OUT_WECHAT_TIP:"点击右上角菜单<br/>在默认浏览器中打开并安装应用",GO_OUT_WECHAT_IOS_TIP:"点击右上角菜单在<br/>Safari 中打开并安装",FOOTER_SLOGAN:'此应用在正在使用 fir.im 免费内测服务，<a href="http://account.fir.im/users/sign_up?utm_source=fir&utm_medium=link&utm_campaign=short_footer&utm_content=slogan">马上注册</a><a class="one-key-report" href="javascript:;">举报!</a>',SAFE:"安全",SAFE_TEXT:"此应用已通过以下安全检测，可放心下载",VIRUS_PASS:"扫描通过",LOW_RISK:"低风险",HIGH_RISK:"高风险",VIRUS:"病毒",RISK:"有风险",RISK_TEXT:"此应用下载有风险，请谨慎下载",KING_SOFT:"猎豹安全大师",BAIDU:"百度手机卫士",POPULARIZE:"推荐应用",DOWNLOAD:"下载",REPORT_RETUEN:"返回下载页",REPORT_SENDING:"正在发送，请稍后...",REPORT_EMAIL:"你的邮箱",REPORT_EMAIL_PLACEHOLDER:"Email",REPORT_EMAIL_ERROR:"请填写有效的邮箱，可及时了解举报结果",REPORT_REASON:"举报原因",REPORT_DB:"盗版",REPORT_HS:"黄色",REPORT_QZ:"欺诈",REPORT_OTHER:"其它",REPORT_REASON_ERROR:"请选择举报类型",REPORT_CONTENT_PLACEHOLDER:"补充举报原因",REPORT_CONTENT_ERROR:"请填写举报原因",REPORT_BUTTON:"举报！",REPORT_THANKS:"感谢你的举报",REPORT_MESSAGE:"我们会尽快核实您的举报内容，关于举报的处理结果将于 1-3 个工作日内发送至你邮箱。",LEGAL_FORBIDDEN:"因法律的要求而被拒绝",LEGAL_FORBIDDEN_LOG:"该 APP 涉及盗版、欺诈、色情或其他不良信息"},en:{AUTO_RETURN_HOME:"Return to home page in <label id='countdown'>{{countdown}}</label> secs",LOADING:"Loading...",DOWNLOAD_INSTALL:"Download",DOWNLOAD_LOADING:"Loading",DATA_ERROR:"Data Error",DATA_INCOMPLETE:"Please contact the app's owner, <a href='/apps/new'>upload again in Rio version</p>",DATA_INCOMPLETE_IN_MOBILE:"Please contact the app's owner upload again",DOWNLOAD_FAILED:"Refresh",VIEW_IN_DESKTOP:"Installing, please check on your home screen",PLATFORM_NOT_MATCHING:"Only support {{app|app_type}} device",CHANGELOG_PLACEHOLDER:"There is no update log",FAILED_LOAD_APP:"Load failed",NOT_FOUND_TITLE:"404 - Not Found",NOT_FOUND_LOG:"Page does not exist",FORBIDDEN_TITLE:"403 - Forbidden",FORBIDDEN_TITLE_LOG:"You don't have permission to view this page",REQUIRE_PWD:"Please enter the password",PASSWORD_WRONG:"Password is not correct",SCAN_TIPS:"Scan the qrcode to download<br/>Open the url on your phone:&nbsp;&nbsp;<span class='text-black'>{{full_short}}</span>",DESC:"Description",CURRENT_VERSION:"Current version",FILE_SIZE:"File size",UPDATED_AT:"Updated at",RELEASES:"Releases",CHANGELOG:"Changelog",VIEW_ALL_APP_RELEASES:"View all {{app.histories|length}} releases",VIEW_ALL_APP_RELEASES_IOS:"View all {{ios.histories|length}} releases",VIEW_ALL_APP_RELEASES_ANDROID:"View all {{android.histories|length}} releases",FOLDING:"Folding",SCREENSHOTS:"Screenshots",INHOUSE:"",ADHOC:"Adhoc",CONFIRM:"Confirm",GO_OUT_WECHAT_IOS_TIP:"Open in Safari and install this app",GO_OUT_WECHAT_TIP:"Open in browser and install this app",FOOTER_SLOGAN:'Supported by fir.im free beta testing service, <a href="http://account.fir.im/users/sign_up?utm_source=fir&utm_medium=link&utm_campaign=short_footer&utm_content=slogan">join now!</a><a class="one-key-report" href="javascript:;">Report!</a>',SAFE:"Safe",SAFE_TEXT:"This application is already passing the security testing, you can start to download it.",VIRUS_PASS:"PASS",LOW_RISK:"Low Risk",HIGH_RISK:"High Risk",VIRUS:"Virus",RISK:"WARNING",RISK_TEXT:"We find out some unknown viruses in this app, please make sure this application is from someone you trust.",KING_SOFT:"CM Security",BAIDU:"Baidu Mobile Security",POPULARIZE:"Hot apps",DOWNLOAD:"Download",REPORT_RETUEN:"Back",REPORT_SENDING:"Sending...",REPORT_EMAIL:"Email",REPORT_EMAIL_PLACEHOLDER:"Your Email",REPORT_EMAIL_ERROR:"Please enter your email address. Once we have reviewed your report, we will notify you by email.",REPORT_REASON:"Reason for report",REPORT_DB:"Pirate",REPORT_HS:"Porn",REPORT_QZ:"Scam",REPORT_OTHER:"Other",REPORT_REASON_ERROR:"Please choose a topic you want to report.",REPORT_CONTENT_PLACEHOLDER:"Please provide details of the reported issue.",REPORT_CONTENT_ERROR:"Please tell us why you want to report this app.",REPORT_BUTTON:"Report！",REPORT_THANKS:"Thank you for helping to make fir.im better!",REPORT_MESSAGE:"We will review your report soon and the result will be sent to you via email within 1 - 3 working days.",LEGAL_FORBIDDEN:"Unavailable For Legal Reasons",LEGAL_FORBIDDEN_LOG:"Unavailable For Legal Reasons"}},m=function(a){return Mark.globals.full_short=a.full_short,Mark.globals.defaultIcon=k,Mark.globals.release_id=a.release_id,Mark.includes.header=$("#header").html(),Mark.includes.footer=$("#footer").html(),Mark.includes.desc=$("#desc").html(),Mark.includes.release=$("#release").html(),Mark.includes.popularize=$("#popularize").html(),Mark.pipes.bytes=function(a){var b,c,d,e;return isNaN(parseFloat(a))||!isFinite(a)?"-":("undefined"==typeof d&&(d=2),e=["byte","KB","MB","GB","TB","PB"],c=Math.floor(Math.log(a)/Math.log(1024)),b=(a/Math.pow(1024,Math.floor(c))).toFixed(d)+" "+e[c])},Mark.pipes.formatDate=function(a){var b,c,d,e,f;return a*=1e3,a=new Date(a),f=a.getMonth()+1+"",1===f.length&&(f="0"+f),c=a.getDate()+"",1===c.length&&(c="0"+c),d=a.getHours()+"",1===d.length&&(d="0"+d),e=a.getMinutes()+"",1===e.length&&(e="0"+e),b=a.getFullYear()+"-"+f+"-"+c+" "+d+":"+e},Mark.pipes.release_type=function(b){return b.release_type?"zh"===a.locale?"inhouse"===b.release_type?"":"内测版":"inhouse"===b.release_type?"inhouse":"Adhoc":""},Mark.pipes.app_type=function(a){return"ios"===a.type?"iOS":"Android"},$.extend(Mark.includes,n[a.locale])},l=function(a,b){var c,d;return c={text:b.text,width:b.width||100,height:b.height||100,colorDark:"#404242",colorLight:b.bg||"#EFF2F2",correctLevel:QRCode.CorrectLevel.L},$(a).html(""),d=new QRCode(a,c),setTimeout(function(){return $(a).attr("title","")},500)},this.FIR={brand:"fir.im 3.0 - Rio",data:{},params:{},elems:{},platform:{},config:{server:"//fir.im/uc_friendly",sameServer:"//download.fir.im",screenshotPrefix:/\/\/firimg\.fir\.im/},ga:function(){var a;if(a=1<=arguments.length?i.call(arguments,0):[],"true"===this.mobileA.is_use_ga)return window.ga.apply(window,a)},collectStore:function(a){return a||(a=window.short),window._hmt.push(["_trackEvent","download","click","store"]),!0},init:function(){return console.info(this.brand),navigator.userAgent.indexOf("UCBrowser")>-1||(this.config.server="//download.fir.im"),/pro\.fir\.im/.test(location.href)&&(this.config.server="//download-pro.fir.im"),this.params.isDebug=/debug=1/.test(location.href),this.params.short=location.pathname.replace("/",""),this.params.full_short=location.href.split("?")[0],console.info("short ",this.params.short),this.virus_data={},this.detectPlatform(),this.readParams(),this.readCookie(),this.setLocale(),this.beforeQuery(),m({locale:this.locale,full_short:this.params.full_short,release_id:this.params.release_id}),this.renderLoading()},detectPlatform:function(){var a;return a=navigator.userAgent,this.platform.isWechat=/micromessenger/i.test(a),this.platform.isQQ=/\s+QQ/.test(a),this.platform.is_mobile=!1,/(android|BB10|linux|NokiaN9)/gi.test(a)?(this.platform.is_ios=!1,this.platform.is_android=!0,this.platform.is_mobile=!0,this.platform.value="android",this.platform.is_phone=!0):/iP(hone|od|ad)/g.test(a)&&(this.platform.is_mobile=!0,this.platform.is_ios=!0,this.platform.is_ipad=/iPad/g.test(a),this.platform.ios_6_x=/OS 6_(\d(_\d)*)/g.test(a),this.platform.is_android=!1,/iP(hone|od)/g.test(a)&&(this.platform.is_phone=!0),this.platform.value="ios"),this.platform.isUnabledInstall=this.platform.isWechat||this.platform.isQQ},readParams:function(){var a,b,c,d;for(b=0,c=location.search.replace("?","").split("&");;){if(a=c[b++],!a)break;d=a.split("="),/release_id/.test(d[0])&&(this.params.release_id=d[1]),/access_token/.test(d[0])&&(this.params.access_token=d[1]),/download_token/.test(d[0])&&(this.params.download_token=d[1]),/access_token/.test(d[0])&&(this.config.access_token=d[1]),/download_token/.test(d[0])&&(this.config.download_token=d[1]),/fir_campaign/.test(d[0])&&(this.params.fir_campaign=d[1]),/fir_source/.test(d[0])&&(this.params.fir_source=d[1])}return console.info("release_id ",this.params.release_id)},readCookie:function(){var a,b,c,d,e;if(!this.config.access_token&&!this.config.download_token){for(d=0,b=document.cookie.split(";"),e=[];;){if(c=b[d++],!c)break;a=c.split("="),/access_token/.test(a[0])&&(this.config.access_token=a[1]),a[0].indexOf("download_token_"+this.params.short)!==-1&&(this.config.download_token=a[1]),a[0].indexOf("download_passwd_"+this.params.short)!==-1&&(this.config.download_passwd=a[1]),a[0].indexOf("locale")!==-1?e.push(this.config.locale=a[1]):e.push(void 0)}return e}},setLocale:function(){return this.config.locale?this.locale=this.config.locale:this.locale=/^zh/.test(navigator.language)?"zh":"en"},buildApp:function(a){var b;return a.market_app_info||(a.market_app_info={}),a.store_link_visible||(a.market_app_info.url=null),(null!=(b=a.releases.history)?b.length:void 0)&&a.releases.history.sort(function(a,b){return b.created_at-a.created_at}),a},store:function(a){var b,c,d,e,f,g;return this.prev_template=this.template_id,a.auth?(this.authorized=!0,this.template_id="app",a.app=this.buildApp(a.app),this[a.app.short]=a.app,a.app&&((b=a.app).icon_url||(b.icon_url=k)),this.app=a.app,a.combo_app&&(a.combo_app=this.buildApp(a.combo_app),a.ios="ios"===a.app.type?a.app:a.combo_app,a.android="android"===a.app.type?a.app:a.combo_app,a.hasMarket=!(!a.ios.market_app_info.url&&!a.android.market_app_info.url),this.platform.is_ios?(a.app=a.ios,(c=a.app).desc||(c.desc=null!=(f=a.android)?f.desc:void 0),delete a.combo_app):this.platform.is_android?(a.app=a.android,(d=a.app).desc||(d.desc=null!=(g=a.ios)?g.desc:void 0),delete a.combo_app):a.combo_app.is_opened&&!a.combo_app.passwd&&(this.has_combo=!0,this.template_id="combo",this[a.combo_app.short]=a.combo_app,(e=a.combo_app).icon_url||(e.icon_url=k)),this.data.apps=[a.ios,a.android])):(this.authorized=!1,a.is_expired?this.template_id="expired":a.constraint?this.template_id="constraint":a.require_pwd?this.template_id="passwd":a.forbidden?this.template_id="forbidden":a.not_found?this.template_id="not_found":a.legal_forbidden?this.template_id="legal_forbidden":a.data_error?this.template_id="data_error":this.template_id="error"),$.extend(this.data,a),this.afterStore()},virusStatus:function(a){var b;switch(b=n[this.locale],a){case"SCANED":return b.VIRUS_PASS;case"LOWRISK":return b.LOW_RISK;case"HIGHRISK":return b.HIGH_RISK;case"VIRUS":return b.VIRUS;default:return""}},storeVirus:function(c){var d,e,f,g,h,i;if(h=(c.releases.master||c.releases).scan_virus,!h)return{};switch(e=h.kingsoft,d=h.baidu,g={virus:[],show:!1,status:0,statusText:""},f=n[this.locale],e&&"NOT_SCANED"!==e&&(i={name:f.KING_SOFT,logo:b},i.status=e,i.statusText=this.virusStatus(e),i.statusText&&g.virus.push(i)),d&&"NOT_SCANED"!==d&&(i={name:f.BAIDU,logo:a},i.status=d,i.statusText=this.virusStatus(d),i.statusText&&g.virus.push(i)),g.virus.length>0?(g.show=!0,1===g.virus.length?g.status=g.virus[0].status:g.virus[0].status===g.virus[1].status?"SCANED"===g.virus[0].status&&(g.status="SCANED"):g.status="RISK"):g.show=!1,g.status){case"SCANED":g.text=f.SAFE,g.statusText=f.SAFE_TEXT,g.safe=!0;break;default:g.text=f.RISK,g.statusText=f.RISK_TEXT}return g},afterStore:function(){var a,b,c,d,e,f,g;if(this.data.is_mobile=this.platform.is_mobile,this.authorized){for(this.data.total_screenshots=0,this.authorized&&(this.data.app.icon_url=this.data.app.icon_url||this.data.app.market_app_info.icon_url,this.data.app.master=this.data.app.releases.master,this.data.app.histories=this.data.app.releases.history,this.data.useToken=!this.data.app.is_opened||this.data.app.has_passwd),this.has_combo&&(this.data.combo_app.master=this.data.combo_app.releases.master,this.data.combo_app.histories=this.data.combo_app.releases.history,(b=this.data.app).desc||(b.desc=this.data.combo_app.desc)),this.params.release_id&&(this.data.app.master=this.data.app.releases),e=[this.data.app,this.data.combo_app],c=0,d=e.length;c<d;c++)a=e[c],a&&("android"===a.type&&a.releases&&(this.virus_data=this.storeVirus(a)),g=[],g=function(){var b,c,d,e;for(d=a.screenshots,e=[],b=0,c=d.length;b<c;b++)f=d[b],this.config.screenshotPrefix.test(f)?e.push(f+"?imageView2/0/w/426/h/240"):e.push(f);return e}.call(this),0===g.length&&a.market_app_info&&Array.prototype.push.apply(g,a.market_app_info.screenshot_urls),this.data.total_screenshots+=Math.min(g.length,5),a.screenshots=g.slice(0,5));return this.data.is_ios="ios"===this.data.app.type,this.data.is_android="android"===this.data.app.type,this.platform.is_mobile&&(this.data.platform_matching=this.data.app.type===this.platform.value),this.data.platform=this.platform,this.data.is_android||(this.data.download_visible=this.data.platform_matching),this.data.is_android?(this.data.show_matching_tips=this.platform.is_ios,this.data.download_visible=!this.platform.is_ios):this.data.show_matching_tips=!this.data.platform_matching&&this.platform.is_phone,this.data.show_app_type_icon=this.platform.is_mobile||!this.has_combo,this.platform.isUnabledInstall?this.data.download_visible=!1:void 0}},beforeQuery:function(){var a;return this.config.url=this.config.server+("/"+this.params.short),this.params.release_id&&(this.config.url+="?release_id="+this.params.release_id),a={},this.config.access_token&&(a["Access-Token"]=this.config.access_token),this.params.access_token&&(a["Access-Token"]=this.params.access_token),this.params.download_token&&(a["Download-Token"]=this.params.download_token),this.config.download_passwd&&(a.Passwd=this.config.download_passwd),this.params.passwd&&(a.Passwd=this.params.passwd),this.config.headers=a},saveDownloadToken:function(a){var b;return this.params.download_token=a,b=new Date(Date.now()+864e5),document.cookie="download_token_"+this.params.short+"="+a+"; expires="+b+"; path=/"},saveDownloadPasswd:function(a){var b;return this.params.download_passwd=a,b=new Date(Date.now()+36e5),document.cookie="download_passwd_"+this.params.short+"="+a+"; expires="+b+"; path=/"},query:function(){var a,b;return b={type:"GET",dataType:"json",url:this.config.url,headers:this.config.headers,timeout:1e4},a=$.extend({},b,{success:this.onQuerySuccess.bind(this),error:function(a){return function(b,c,d){var e;return e=b.status,window._hmt.push(["_trackEvent","download","query",e]),a.onQueryFail(b,c,d)}}(this),complete:function(a){return function(c,d){return 0===c.status?a.requery(b):a.render()}}(this)}),$.ajax(a)},requery:function(a){var b;return a.url=a.url.replace(this.config.server,this.config.sameServer),b=$.extend({},a,{success:function(a){return function(b,c,d){return window._hmt.push(["_trackEvent","download","requery",d.status]),a.onQuerySuccess(b,c,d)}}(this),error:function(a){return function(b,c,d){var e,f;window._hmt.push(["_trackEvent","download","requeryError",b.status]),f=b.responseText||b.response;try{f=JSON.stringify(f)}catch(g){e=g}return a.onQueryFail(b,c,d)}}(this),complete:function(a){return function(){return a.render()}}(this)}),$.ajax(b)},onQuerySuccess:function(a,b,c){var e,f,g,i,j,k,l,m;try{a.app=h(a.app),a.combo_app=h(a.combo_app),e=a.app,f=e.token,this.platform.is_mobile&&a.combo_app&&("android"!==e.type||this.platform.is_android?"ios"===e.type&&this.platform.is_android&&(e=a.combo_app,d(a,"combo_app","app")):(e=a.combo_app,d(a,"combo_app","app"))),(e.releases.is_onlined||(null!=(i=e.releases.master)?i.is_onlined:void 0))&&(null!=(j=e.market_app_info)?j.url:void 0)?(m=e.market_app_info.url,window._hmt.push(["_trackPageview","/"+window.short+"-redirectToAppstore"]),setTimeout(function(){return window.location.href=m},300)):window._hmt.push(["_trackPageview",location.pathname])}catch(n){return g=n,void alert("Error: Unable to get token")}return e&&(e.is_expired||e.constraint)?(this.platform.isUnabledInstall||(a.auth=!1,a.is_expired=e.is_expired,a.constraint=e.constraint,a.app=void 0),e.is_expired&&window._hmt.push(["_trackEvent","download","is_expired"]),e.constraint&&window._hmt.push(["_trackEvent","download","is_constraint"]),this.store(a)):(a.auth&&!a.app.has_passwd&&this.saveDownloadToken(f),this.config.headers.Passwd&&this.saveDownloadPasswd(this.config.headers.Passwd),l=a.app.releases,!l||0===(null!=(k=l.history)?k.length:void 0)&&!l.master?(console.info("没有版本信息"),this.store({auth:!1,data_error:!0}),void window._hmt.push(["_trackEvent","download","query","no-releases"])):(this.params.isDebug&&a.auth&&alert(JSON.stringify({name:a.app.name,token:a.app.token},"\n",2)),this.store(a)))},onQueryFail:function(a,b,c){var d,e,f,g,h;switch(g=a.status){case 0:return this.store({auth:!1});case 404:return this.store({auth:!1,not_found:!0});case 451:return this.store({auth:!1,legal_forbidden:!0});default:h=a.response||a.responseText;try{f=JSON.parse(h),this.store(f)}catch(i){d=i,bughd("notifyException",d,{resp:h})}e=h;try{return e=JSON.stringify(h)}catch(i){d=i}}},renderLoading:function(){var a,b;return b=$("#loading").html(),a=Mark.up(b),g.html(a)},getTooltipOffset:function(a,b){var c,d;return a||(a=$(".tip")),c=a.offset(),d={top:c.top+25,left:c.left-20}},renderTooltip:function(){var a,b,c,d,e,f;if(d=$("#virus_result").html(),e=Mark.up(d,this.virus_data),this.has_combo?(a=$(".per-type-info .icon-android"),a.parent().append(e)):($("header .name").append(e),b="en"===this.locale?195:200,$("header .name .icon-warp").css("max-width",b+"px")),!this.platform.is_mobile)return d=$(".tip"),"en"===this.locale&&d.addClass("en"),f=$("#tooltip").html(),f=Mark.up(f,this.virus_data),$("body").append(f),f=$(f),c=this.getTooltipOffset(d,f),f.css("top",c.top).css("left",c.left)},renderMobileAD:function(){var a;return a=this.platform.is_android?"android":this.platform.is_ipad?"ipad":"ios",this.platform.adType=a,$.ajax({url:"//api.fir.im/box/"+a,method:"get",success:function(a){return function(b){var c,d,f;if(b)return f=$("#app_bottom_fixed").html()||"",c=Mark.up(f,b),a.mobileA=b,d=new Image,d.onload=function(){var d,f;return f=a.platform.adType,d=e(b.content),a.ga("set","dimension1",window.short),a.platform.isWechat?(a.ga("send","event","adFooter","render",d+"-wechat"),window._hmt.push(["_trackEvent","adFooter","render",f+"-wechat"])):(a.ga("send","event","adFooter","render",d),window._hmt.push(["_trackEvent","adFooter","render",f])),$("body").append(c)},d.src=b.content}}(this)})},render:function(){var a,b,d;return"passwd"===this.prev_template&&"passwd"===this.template_id?($("#required-pwd").hide(),$("#passwd-wrong").show(),void setTimeout(function(){return $("#required-pwd").show(),$("#passwd-wrong").hide()},2e3)):(this.authorized?(a=$("#meta").html(),this.data.app.desciption=this.data.app.desc,b=Mark.up(a,this.data.app),$("head").append(b),c.removeClass("no-scroll")):"passwd"===this.template_id&&(a=$("#meta_simple").html(),b=Mark.up(a,this.data.app),$("head").append(b)),this.has_combo&&c.addClass("combo"),d=$("#"+this.template_id).html()||"",b=Mark.up(d,this.data),g.html(b),this.virus_data.show&&this.renderTooltip(),(this.platform.is_android||this.platform.is_ios)&&$("main header table").height(Math.min(j,900)),c.addClass(this.template_id),this.platform.isUnabledInstall&&(this.data.app&&setTimeout(function(){return c.addClass("show-wechat-notice")},300),c.append(Mark.up($("#wechat_notice").html()))),this.afterRender())},afterRender:function(){var a,b,c,d;return this.platform.is_mobile&&this.data.app&&this.data.app.is_embedded_ad?this.renderMobileAD():this.getOtherApps(this.data.app),this.OneKeyReport(this.data.app),this.pickElement(),this.authorized?(this.generateQrcode(),this.loadIcon(),$(".releases-section").delegate(".changelog-toggle","click",function(a){return $(this).parent().next().toggleClass("show")}),$(".releases-toggle").click(function(a){return $(this).parents(".releases-section").toggleClass("show-all"),$(this).parent().hide()})):(a=$(".app-brief img.icon"),a.error(function(){return a.attr("src",k)})),this.data.require_pwd&&($("#confirmPwd").click(function(a){return FIR.confirmPasswd()}),this.generateQrcode()),"not_found"!==this.template_id&&"legal_forbidden"!==this.template_id&&"forbidden"!==this.template_id||setTimeout(function(){return g.find(".main header").removeClass("fade-out")},200),c=$(".tip"),d=$(".tooltip"),b=this,c.on("mouseenter",function(a){var c,e;return e=a.target,c=b.getTooltipOffset($(e),d),d.css("top",c.top).css("left",c.left).show()}),c.on("mouseleave",function(a){return d.hide()})},generateQrcode:function(){var a,b,c;return b=this.elems.head_qrcode[0],c=this.params.full_short,c+="?utm_source=fir&utm_medium=qr",!this.data.app.token||!this.data.app.passwd&&this.data.app.is_opened||(c+="&download_token="+this.data.app.token),this.params.release_id&&(c+="&release_id="+this.params.release_id),this.params.fir_source&&(c+="&fir_source="+this.params.fir_source),this.params.fir_campaign&&(c+="&fir_campaign="+this.params.fir_campaign),l(b,{text:c,width:200,height:200}),console.info("QRCode url: ",c),a=$(".release-qrcode"),a.each(function(a){return function(b,d){var e,f,g;return a.has_combo?(f=$(d).parents(".type").data("app-short"),e=a[f]):e=a.data.app,g=$(d).data("release"),c=location.protocol+"//"+location.host+"/"+e.short+"?release_id="+g,c+="&utm_source=fir&utm_medium=qr",e.is_opened&&!e.passwd||(c+="&download_token="+e.token),l(d,{text:c,bg:"#FFFFFF",width:180,height:180})}}(this))},loadIcon:function(){var a;if(a=$("header .icon img"),this.data.app.icon_url!==k)return a.error(function(){return a.attr("src",k)})},pickElement:function(){return this.elems.passwd_field=$("#passwdField"),this.elems.head_qrcode=$(".app-brief .qrcode")},confirmPasswd:function(){var a;return!!(a=this.elems.passwd_field.val())&&(this.params.passwd=a,this.beforeQuery(),this.query(),!1)},plistUrl:function(a){var b,c,d;return b=this.config.server,d=this.platform.ios_6_x?"http":"https",c=d+"://fir.im/plists/"+a,"itms-services://?action=download-manifest&url="+encodeURIComponent(c)},beforeInstall:function(a){return this.config.headers["Download-Token"]=this.data.app.token,this.config.download_url=this.config.server+"/apps/"+this.data.app.id+"/install?release_id="+a,this.config.download_url+="&download_token="+this.data.app.token},iosSchema:function(a){var b,c,d;return d="https:",b=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),b&&(c=parseInt(b[1],10),d=c>6?"https:":"http:"),"itms-services://?action=download-manifest&url="+encodeURIComponent(d+a)},install:function(a){var b,c;return this.platform.isUnabledInstall?void window._hmt.push(["_trackEvent","download","click","wechat-install"]):(b=$("#actions button"),b.html("&nbsp;").css({"min-width":"43px",width:"43px",padding:"12px 0","border-top-color":"transparent","border-left-color":"transparent"}).prop("disabled",!0),setTimeout(function(){return b.addClass("loading")},200),"ios"===this.data.app.type&&setTimeout(function(a){return function(){return $("#actions").html("<p style='padding: 12px;color: #3AB2A7;'>"+n[a.locale].VIEW_IN_DESKTOP+"</p>")}}(this),5e3),window._hmt.push(["_trackEvent","download","click","install"]),void(this.platform.isUnabledInstall||(c=this.getInstallUrl(a),window.location=c)))},getInstallUrl:function(a){var b;return b=this.config.server+"/apps/"+this.data.app.id+"/install?download_token="+this.data.app.token,a=a||this.params.release_id||this.data.app.master.id,a&&(b+="&release_id="+a),this.params.fir_campaign&&(b+="&fir_campaign="+this.params.fir_campaign),this.params.fir_source&&(b+="&fir_source="+this.params.fir_source),f()&&(b+="&protocol=http"),"ios"===this.data.app.type&&(b=this.iosSchema(b)),b},getOtherApps:function(a){var b,c,d,e;if(b=!a||a.is_ad_app)return e="android",c=!1,this.platform.is_mobile?(c=!0,e=this.platform.is_android?"android":"ios"):e=a?a.type:"android",d=this.config.server+"/t/list",$.ajax({type:"GET",dataType:"json",data:{type:e},url:d,success:function(b,d,e){var f,g,h,i,j,k;for(i=0,j=b.length;i<j;i++)a=b[i],a.is_mobile=c;return f=$("#popularize-list"),g=$("#popularize-template"),h=Mark.up(g.html(),{apps:b}),k=!1,f.html(h).parent().show().find("a.app-wrap").click(function(){var a;return a=$this,window._hmt.push(["_trackEvent","download","appAdClick",this.getAttribute("data")]),setTimeout(function(){return document.location=a.attr("href")},300),!1})},error:function(a,b,c){},complete:function(a,b){}})},OneKeyReport:function(a){var b,c,d,e,f;if(a&&(b=$("body").find("div.main > div.footer > a.one-key-report"),!(b.length<1)))return e=this.platform.is_mobile,d=this,f="//api.fir.im/apps/"+a.id+"/report_email",c=$(Mark.up($("#report-template").html(),this.config)),$("body").append(c),c.find("div.dialog-close").click(function(){return d.hideDialog()}),c.find("div.dialog-action>a.btn-report").click(function(){var a,b,d;return b=$("#report-email"),d=$("#report-type").find(".active"),a=$("#report-content"),""!==b.val().trim()&&/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(b.val().trim())?d.length<1?c.find("div.type-error").show().siblings().hide():""===a.val().trim()?(a.focus(),c.find("div.message-error").show().siblings().hide()):$.ajax({url:f,type:"post",data:{email:""+b.val().trim(),tag:d.html(),content:""+a.val().trim()},beforeSend:function(){return $("#report-sending").show()},success:function(a){return $("div.report-form").hide(),$("div.report-feedback").show()},error:function(){return alert("举报错误，请稍后重试")},complete:function(){return $("#report-sending").hide()}}):(b.focus(),c.find("div.email-error").show().siblings().hide())}),c.find("div.custom-checkbox").click(function(){return $(this).addClass("active").siblings().removeClass("active")}),b.click(function(){return d.showReport()})},showReport:function(){var a;return $("body").addClass("hidden-overflow"),this.resetReport(),this.platform.is_mobile||$("#MaskLayer").show(),
this.platform.is_mobile?(a=$("#reportDialog").css({left:"100%",display:"block"}).addClass("animate"),window.setTimeout(function(){return a.css("left","0")},1)):$("#reportDialog").show()},hideDialog:function(){var a;return this.platform.is_mobile||$("#MaskLayer").hide(),this.platform.is_mobile?(a=$("#reportDialog").addClass("animate").css("left","100%"),window.setTimeout(function(){return a.hide()},500)):$("#reportDialog").hide(),$("body").removeClass("hidden-overflow")},resetReport:function(){return $("#report-email").val(""),$("#report-type").find("div.custom-checkbox").removeClass("active"),$("#report-content").val(""),$("#report-error").find("div").hide(),$("#report-form").show(),$("#report-feedback").hide()},clickFooterAd:function(){var a,b,c,d;if(a=this.mobileA,c=function(a){return setTimeout(function(){return window.location.href=a},500)},a)return d=this.platform.adType,b=e(a.content),this.platform.isWechat?(this.ga("send","event","adFooter","download",b+"-wechat"),window._hmt.push(["_trackEvent","adFooter","download",d+"-wechat"])):(this.ga("send","event","adFooter","download",b),window._hmt.push(["_trackEvent","adFooter","download",d])),c(a.redirect_url)}},FIR.init(),FIR.query()})}).call(this);